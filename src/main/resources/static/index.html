<!DOCTYPE html>
<html lang="pt-br" ng-app="crudApp">
<head>
  <meta charset="utf-8" />
  <title>Itens - CRUD AngularJS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap (opcional, só para layout rápido) -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"/>

  <!-- AngularJS 1.x -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.3/angular.min.js"></script>

  <style>
    body { padding: 24px; }
    .panel-heading .btn { margin-left: 8px; }
    .error { color: #c9302c; }
    .success { color: #3c763d; }
    .pointer { cursor: pointer; }
    .mt-16 { margin-top: 16px; }
    .mb-16 { margin-bottom: 16px; }
    .table > tbody > tr > td { vertical-align: middle; }
  </style>
</head>
<body ng-controller="CrudController as vm">

  <div class="container-fluid">

    <div class="row">
      <div class="col-md-8">
        <div class="panel panel-default">
          <div class="panel-heading">
            <strong>Itens</strong>
            <div class="pull-right">
              <button class="btn btn-xs btn-default" ng-click="vm.reload()">
                Recarregar
              </button>
            </div>
          </div>

          <div class="panel-body">
            <!-- Filtros simples -->
            <div class="row mb-16">
              <div class="col-sm-6">
                <input type="text" class="form-control" placeholder="Filtrar por nome/descrição (client-side)"
                       ng-model="vm.filterText">
              </div>
              <div class="col-sm-6 text-right">
                <label>Página:</label>
                <button class="btn btn-default btn-sm" ng-disabled="vm.page===0" ng-click="vm.prevPage()">&laquo;</button>
                <span class="btn btn-default btn-sm disabled">{{ vm.page + 1 }} / {{ vm.totalPages || 1 }}</span>
                <button class="btn btn-default btn-sm" ng-disabled="vm.page+1 >= vm.totalPages" ng-click="vm.nextPage()">&raquo;</button>
                <select class="btn btn-default btn-sm" ng-model="vm.size" ng-change="vm.loadPage(0)">
                  <option value="5">5</option>
                  <option value="10" selected>10</option>
                  <option value="20">20</option>
                </select>
              </div>
            </div>

            <!-- Tabela -->
            <div class="table-responsive">
              <table class="table table-striped table-hover">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Descrição</th>
                    <th>Status</th>
                    <th class="text-right">Preço</th>
                    <th>Categoria</th>
                    <th width="140">Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="it in vm.items | filter:vm.searchFilter">
                    <td>{{ it.id }}</td>
                    <td>{{ it.nome }}</td>
                    <td>{{ it.descricao }}</td>
                    <td>{{ it.status }}</td>
                    <td class="text-right">{{ it.preco | currency:'R$ ' }}</td>
                    <td>{{ it.categoria }}</td>
                    <td>
                      <button class="btn btn-xs btn-primary" ng-click="vm.edit(it)">Editar</button>
                      <button class="btn btn-xs btn-danger" ng-click="vm.remove(it)">Excluir</button>
                    </td>
                  </tr>
                  <tr ng-if="!vm.items.length">
                    <td colspan="7" class="text-center text-muted">Nenhum item encontrado</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="text-right">
              <small>Total: {{ vm.totalItems }} itens</small>
            </div>

            <!-- Mensagens -->
            <div class="mt-16">
              <p class="success" ng-if="vm.msgSuccess">{{ vm.msgSuccess }}</p>
              <p class="error" ng-if="vm.msgError">{{ vm.msgError }}</p>
            </div>

          </div>
        </div>
      </div>

      <!-- Formulário -->
      <div class="col-md-4">
        <div class="panel panel-info">
          <div class="panel-heading">
            <strong>{{ vm.form.id ? 'Editar Item #' + vm.form.id : 'Novo Item' }}</strong>
            <div class="pull-right">
              <button class="btn btn-xs btn-default" ng-click="vm.resetForm()">Limpar</button>
            </div>
          </div>
          <div class="panel-body">
            <form novalidate ng-submit="vm.save()">
              <div class="form-group">
                <label>Nome</label>
                <input type="text" class="form-control" ng-model="vm.form.nome" required />
              </div>

              <div class="form-group">
                <label>Descrição</label>
                <textarea class="form-control" ng-model="vm.form.descricao"></textarea>
              </div>

              <div class="form-group">
                <label>Status</label>
                <select class="form-control" ng-model="vm.form.status" required>
                  <option value="ATIVO">ATIVO</option>
                  <option value="INATIVO">INATIVO</option>
                </select>
              </div>

              <div class="form-group">
                <label>Preço</label>
                <input type="number" step="0.01" class="form-control" ng-model="vm.form.preco" required />
              </div>

              <div class="form-group">
                <label>Categoria</label>
                <input type="text" class="form-control" ng-model="vm.form.categoria" />
              </div>

              <button type="submit" class="btn btn-success btn-block">
                {{ vm.form.id ? 'Atualizar' : 'Criar' }}
              </button>
            </form>
          </div>
        </div>

        <!-- Detalhes (GET por ID) -->
        <div class="panel panel-default">
          <div class="panel-heading"><strong>Buscar por ID</strong></div>
          <div class="panel-body">
            <div class="input-group">
              <input type="number" class="form-control" placeholder="ID..."
                     ng-model="vm.lookupId" />
              <span class="input-group-btn">
                <button class="btn btn-default" type="button" ng-click="vm.fetchById()">Buscar</button>
              </span>
            </div>

            <pre ng-if="vm.lookupItem" class="mt-16">{{ vm.lookupItem | json }}</pre>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="app.js"></script>
</body>
</html>
